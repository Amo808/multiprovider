# RAG Parameters - –ß—Ç–æ –†–µ–∞–ª—å–Ω–æ –†–∞–±–æ—Ç–∞–µ—Ç

## üéØ –ì–ª–∞–≤–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### `max_percent_limit` (%)

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–∞–∂–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä!** –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.

* **5%** - –±—ã—Å—Ç—Ä—ã–π —Ç–æ—á–Ω—ã–π –ø–æ–∏—Å–∫
* **20-30%** - —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
* **50%** - –º–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
* **100%** - –≤–µ—Å—å –¥–æ–∫—É–º–µ–Ω—Ç

**–ü—Ä–∏–º–µ—Ä:** –î–æ–∫—É–º–µ–Ω—Ç 1000 —á–∞–Ω–∫–æ–≤ (~500 —Å—Ç—Ä–∞–Ω–∏—Ü). –ü—Ä–∏ `max_percent_limit=30%` –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –º–∞–∫—Å–∏–º—É–º 300 —á–∞–Ω–∫–æ–≤ (~150 —Å—Ç—Ä–∞–Ω–∏—Ü).

***

## üìä –†–µ–∂–∏–º—ã (`chunk_mode`)

| –†–µ–∂–∏–º | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|-------|------------|-------------------|
| `percent` | –í—Å–µ–≥–¥–∞ –±–µ—Ä—ë—Ç –∑–∞–¥–∞–Ω–Ω—ã–π % | –ö–æ–≥–¥–∞ –Ω—É–∂–µ–Ω –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
| `adaptive` | AI —Ä–µ—à–∞–µ—Ç –æ—Ç 5% –¥–æ max\_percent\_limit | –£–º–Ω—ã–π —Ä–µ–∂–∏–º - –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–¥–∞—á |
| `fixed` | –§–∏–∫—Å. —á–∏—Å–ª–æ —á–∞–Ω–∫–æ–≤ (legacy) | –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è |

***

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|------------|--------------|
| `min_similarity` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å | 40% |
| `keyword_weight` | –í–µ—Å —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å–ª–æ–≤ | 30% |
| `semantic_weight` | –í–µ—Å –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å–º—ã—Å–ª–∞ | 70% |
| `use_rerank` | AI –ø–µ—Ä–µ—Ä–∞–Ω–∂–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã | ‚úÖ –î–∞ |

***

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (—Å–∫—Ä—ã—Ç—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|----------|------------|--------------|
| `max_chunks` | –î–ª—è fixed —Ä–µ–∂–∏–º–∞ | 50 |
| `min_chunks` | –ú–∏–Ω–∏–º—É–º —á–∞–Ω–∫–æ–≤ | 5 |
| `max_chunks_limit` | –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –ª–∏–º–∏—Ç (–∑–∞—â–∏—Ç–∞) | 10000 |

**–í–∞–∂–Ω–æ:** `max_chunks_limit` —ç—Ç–æ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è!

***

## üì§ –ß—Ç–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ –±—ç–∫–µ–Ω–¥

–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:

```json
{
  "rag": {
    "enabled": true,
    "mode": "smart",
    "chunk_mode": "adaptive",
    "max_percent_limit": 30,
    "chunk_percent": 30,
    "min_similarity": 0.4,
    "keyword_weight": 0.3,
    "semantic_weight": 0.7,
    "use_rerank": true,
    
    // –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ (–Ω–µ –º–µ–Ω—è—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º):
    "max_chunks": 50,
    "min_chunks": 5,
    "max_chunks_limit": 10000
  }
}
```

***

## üßÆ –ö–∞–∫ –±—ç–∫–µ–Ω–¥ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –ª–∏–º–∏—Ç

```python
# –í calculate_target_chunks():

# 1. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–π –ª–∏–º–∏—Ç
percent_limit = total_chunks * (max_percent_limit / 100)

# 2. –ë–µ—Ä—ë–º –º–∏–Ω–∏–º—É–º –∏–∑ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–≥–æ
effective_limit = min(max_chunks_limit, percent_limit)

# 3. –ü—Ä–∏–º–µ–Ω—è–µ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
target = max(target, min_chunks)  # –ù–µ –º–µ–Ω—å—à–µ –º–∏–Ω–∏–º—É–º–∞
target = min(target, effective_limit)  # –ù–µ –±–æ–ª—å—à–µ –ª–∏–º–∏—Ç–∞
target = min(target, total_chunks)  # –ù–µ –±–æ–ª—å—à–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞
```

**–ü—Ä–∏–º–µ—Ä:**

* –î–æ–∫—É–º–µ–Ω—Ç: 1000 —á–∞–Ω–∫–æ–≤
* max\_percent\_limit: 30%
* max\_chunks\_limit: 10000

‚Üí percent\_limit = 300
‚Üí effective\_limit = min(10000, 300) = **300**
‚Üí –ò—Ç–æ–≥: –º–∞–∫—Å–∏–º—É–º 300 —á–∞–Ω–∫–æ–≤

***

## ‚úÖ –£–ø—Ä–æ—â—ë–Ω–Ω—ã–π UI

–í UI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ:

1. **–†–µ–∂–∏–º** (–§–∏–∫—Å % / –£–º–Ω—ã–π)
2. **–°–ª–∞–π–¥–µ—Ä –ø—Ä–æ—Ü–µ–Ω—Ç–∞** (5-100%)
3. **–ü–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏** (10-90%)
4. **–ë–∞–ª–∞–Ω—Å –ø–æ–∏—Å–∫–∞** (–∫–ª—é—á–µ–≤—ã–µ/—Å–µ–º–∞–Ω—Ç–∏–∫–∞)
5. **Rerank** (–≤–∫–ª/–≤—ã–∫–ª)

–í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
